# Story 3.1: Test Data Generation (50-100 Pages)

**Epic:** Epic 3 - Scale Testing & Performance Validation
**Story Number:** 3.1
**Priority:** HIGH (foundational for Epic 3)
**Estimated Duration:** 4-6 hours

---

## Status

**Draft** ⏳

Story created by Scrum Master. Ready for development team review and approval.

---

## Story

**As a** development team,
**I want** to generate 50-100 test page records in Airtable with diverse service/location combinations and realistic content,
**so that** we can validate system performance at scale and ensure the static site generation system can handle production-level page volumes.

---

## Acceptance Criteria

1. **50-100 page records created** in Airtable Pages table
2. **Data diversity ensured** across multiple dimensions:
   - Minimum 3 different services (e.g., bathroom-remodeling, kitchen-remodeling, plumbing)
   - Minimum 15 different locations (cities/regions)
   - Varied combinations to simulate real-world usage
3. **All required fields populated** for valid page generation:
   - Service Slug and Location Slug (required for routing)
   - H1 Headline and Hero content
   - AI-generated content fields (Benefits, FAQs, Process Steps as JSON)
   - SEO metadata (title, description)
   - Trust Bar signals
4. **Export script successful** - `npm run export-airtable` generates valid content.json with 50-100 pages
5. **Build validation** - `npm run build` completes successfully with all test pages

---

## Tasks / Subtasks

- [ ] **Task 1: Review existing Airtable schema and data structure** (AC: 1, 2, 3)
  - [ ] Examine current 2 pages in Airtable to understand data patterns
  - [ ] Review Pages table schema (50+ fields) from `docs/architecture/data-models.md`
  - [ ] Identify required vs optional fields for page generation
  - [ ] Document field dependencies (e.g., Service Slug → service routing)
  - [ ] Review existing Services and Locations tables for available options

- [ ] **Task 2: Determine test data generation approach** (AC: 1, 2)
  - [ ] Evaluate options: Manual Airtable entry vs scripted data generation vs CSV import
  - [ ] Recommend approach based on time/accuracy trade-offs
  - [ ] If scripting: Design data generation script architecture
  - [ ] Define service/location combination matrix (3 services × 15 locations = 45 minimum pages)
  - [ ] Plan for 50-100 pages with varied combinations

- [ ] **Task 3: Create test Services and Locations foundation data** (AC: 2)
  - [ ] Add 3+ service records to Services table (bathroom-remodeling, kitchen-remodeling, plumbing, etc.)
  - [ ] Add 15+ location records to Locations table (diverse cities/regions)
  - [ ] Ensure slugs are URL-friendly (lowercase, hyphens only)
  - [ ] Verify foundation tables have required fields populated

- [ ] **Task 4: Generate 50-100 test page records** (AC: 1, 2, 3)
  - [ ] Populate Pages table with service/location combinations
  - [ ] **Required Fields:**
    - [ ] Service Slug (linked to Services table or direct entry)
    - [ ] Location Slug (linked to Locations table or direct entry)
    - [ ] H1 Headline (e.g., "Expert {Service} in {Location}")
    - [ ] Hero Subheadline
    - [ ] SEO Title (50-60 chars)
    - [ ] SEO Description (150-160 chars)
    - [ ] Trust Bar signals (5 items)
  - [ ] **AI-Generated Content Fields (JSON format):**
    - [ ] Benefits (array of 6 benefit objects with title/description/icon)
    - [ ] Process Steps (array of 6 step objects with stepNumber/title/description/timeline)
    - [ ] FAQs (array of 10 FAQ objects with question/answer)
  - [ ] Use realistic sample data from existing pages as templates
  - [ ] Ensure data diversity (varied headlines, descriptions, trust signals)

- [ ] **Task 5: Validate data quality and completeness** (AC: 3)
  - [ ] Spot-check 10 random pages for field completeness
  - [ ] Verify JSON fields are valid JSON (Benefits, Process Steps, FAQs)
  - [ ] Check Service Slug and Location Slug format (lowercase, hyphens, no spaces)
  - [ ] Validate SEO metadata character limits
  - [ ] Ensure all required fields have non-empty values
  - [ ] Document any data quality issues found

- [ ] **Task 6: Run export script and validate content.json** (AC: 4)
  - [ ] Execute `npm run export-airtable` to generate content.json
  - [ ] Verify content.json contains 50-100 pages in `pages` array
  - [ ] Check export metadata (totalPages count matches expectation)
  - [ ] Validate JSON structure matches EnhancedPageData interface
  - [ ] Spot-check 5 random pages in content.json for data accuracy
  - [ ] Verify testimonials and staff data filtered correctly (if applicable)

- [ ] **Task 7: Validate build process with test data** (AC: 5)
  - [ ] Run `npm run type-check` (must pass with 0 errors)
  - [ ] Run `npm run lint` (must pass)
  - [ ] Run `npm run build` (must complete successfully)
  - [ ] Verify build output shows 50-100 static pages generated
  - [ ] Check build time and record for performance baseline
  - [ ] Spot-check 3 random generated pages in `out/` directory

---

## Dev Notes

### Current State

**Existing Data:**
- 2 pages currently in content.json (both bathroom-remodeling/strongsville)
- Airtable base: `appATvatPtaoJ8MmS`
- Export script: `scripts/export-airtable-to-json.ts`

**Epic 3 Goal:**
- Scale to 50-100 pages for performance testing
- Validate system capability at production scale
- Establish performance baseline for build times

[Source: content.json metadata, docs/prd/epic-list.md:84-112]

### Airtable Schema Context

**12-Table Schema (Production-Ready, LOCKED):**

**Foundation Tables:**
1. **Clients** - Business info, branding, tracking IDs
2. **Services** - Service definitions with keyword grouping
3. **Locations** - City master data with demographics
4. **Branch Locations** - Physical office locations
5. **Service Areas** - Junction table (branches serve cities)
6. **Branch Staff** - Team member profiles

**Core Content:**
7. **Pages** - Landing page content (50+ fields) ⭐ PRIMARY TABLE FOR THIS STORY

**Content Libraries:**
8. **CTAs** - Call-to-action library
9. **Hero Images Library** - Image assets
10. **Testimonials** - Customer reviews

**Marketing:**
11. **Offers** - Promotional campaigns
12. **Campaigns** - UTM tracking

**⚠️ CRITICAL:** Schema is LOCKED - do NOT modify tables or fields. ONLY create/update records.

[Source: docs/architecture/data-models.md:15-70]

### Pages Table - Key Fields for Test Data

**Required Fields (must be populated):**
- `Service Slug` (String or Array) - routing key (e.g., "bathroom-remodeling")
- `Location Slug` (String or Array) - routing key (e.g., "strongsville")
- `H1 Headline` (String) - page headline
- `Hero Subheadline` (String) - supporting text
- `SEO Title` (String) - 50-60 characters
- `SEO Description` (String) - 150-160 characters
- `Trust Bar 1-5` (Strings) - 5 trust signals

**AI-Generated Content Fields (JSON format):**
- `Benefits` (Long Text, JSON) - Array of 6 benefit objects:
  ```json
  [
    {
      "title": "Licensed & Insured Professionals",
      "description": "All contractors fully licensed...",
      "icon": "shield"
    }
  ]
  ```
- `Process Steps` (Long Text, JSON) - Array of 6 step objects:
  ```json
  [
    {
      "stepNumber": 1,
      "title": "Free Consultation",
      "description": "Schedule your complimentary...",
      "timeline": "Day 1"
    }
  ]
  ```
- `FAQs` (Long Text, JSON) - Array of 10 FAQ objects:
  ```json
  [
    {
      "question": "How much does a bathroom remodel cost?",
      "answer": "The cost varies based on..."
    }
  ]
  ```

**Optional Fields (can be empty for test data):**
- Branch info (name, phone, email, address)
- Branding (colors, logo) - defaults to primary/secondary colors
- Tracking (GTM ID, GA Property ID)
- Offer ID (linked record)

[Source: scripts/export-airtable-to-json.ts:245-423, docs/architecture/data-models.md:73-91]

### Export Script Behavior

**Script:** `scripts/export-airtable-to-json.ts`

**Process:**
1. Fetches 3 tables in parallel: Pages, Testimonials, Branch Staff
2. Filters Pages: MUST have `Service Slug` and `Location Slug` (validation errors logged)
3. Transforms to EnhancedPageData interface
4. Filters testimonials by client/service/branch match
5. Outputs `content.json` in project root

**Key Validation Logic:**
```typescript
// Lines 259-267: Required field validation
if (!serviceSlug) {
  errors.push(`${page.id}: Missing Service Slug`)
  continue
}
if (!locationSlug) {
  errors.push(`${page.id}: Missing Location Slug`)
  continue
}
```

**Success Output:**
```
✅ Export Complete!
   Pages exported: 50-100
   File size: ~XX KB
   Duration: XXXms
   Output: /content.json
```

[Source: scripts/export-airtable-to-json.ts:1-492]

### Data Generation Strategies

**Option 1: Manual Airtable Entry (Recommended for MVP)**
- **Pros:** Full control, Airtable UI validation, matches production workflow
- **Cons:** Time-intensive for 100 pages (~2-3 hours)
- **Best for:** 50 pages, when data quality is critical

**Option 2: Scripted Data Generation + Airtable API**
- **Pros:** Fast, repeatable, can generate 100+ pages quickly
- **Cons:** Requires script development, API rate limits (5 req/sec), more complex
- **Best for:** 100 pages, when speed is priority

**Option 3: CSV Import via Airtable**
- **Pros:** Balance of speed and control, CSV can be version-controlled
- **Cons:** JSON fields (Benefits, FAQs) tricky in CSV, requires manual mapping
- **Best for:** 50-75 pages, mix of efficiency and visibility

**Recommendation:** Start with **Option 1 (Manual Entry)** for 50 pages to maintain data quality and match production workflow. If 100 pages needed, supplement with Option 2.

[Source: Architect recommendation based on Airtable API limits and Epic 3 scope]

### Data Validation Rules

**From Architecture Standards:**

**Service Slug:**
- Lowercase only
- Hyphens for spaces
- No special characters
- Example: `bathroom-remodeling`, `kitchen-remodeling`, `plumbing`

**Location Slug:**
- Lowercase only
- Hyphens for spaces
- No special characters
- Example: `strongsville`, `charlotte`, `cleveland`

**SEO Metadata:**
- Title: 50-60 characters (Google SERP limit)
- Description: 150-160 characters (Google SERP limit)

**JSON Fields:**
- Must be valid JSON syntax
- Arrays must have correct structure (objects with required keys)
- Use existing pages as templates to avoid schema errors

[Source: docs/architecture/data-models.md:298-309]

### Testing

**Manual QA Approach (per MVP testing strategy):**

**Pre-Export Validation:**
- Spot-check 10 random pages in Airtable for field completeness
- Verify JSON fields parse correctly (paste into JSON validator)
- Check Service/Location slug format

**Post-Export Validation:**
- Run `npm run type-check` (0 errors required)
- Run `npm run lint` (must pass)
- Run `npm run build` (must complete)
- Verify build output page count matches expectation
- Spot-check 3 random pages in `out/` directory for content accuracy

**Build Performance:**
- Record build time for 50-100 pages (baseline for Epic 3.2)
- Target: <5 minutes for 100 pages (per Epic 3 success criteria)

[Source: docs/architecture/testing.md:9-18, docs/prd/epic-list.md:101]

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-16 | 1.0 | Story 3.1 created for Epic 3 Scale Testing & Performance Validation. Defines test data generation requirements (50-100 pages) with comprehensive Airtable schema context, export script behavior, data validation rules, and three data generation strategy options. Critical foundation for Epic 3 scale testing. | Bob (SM Agent) |

---

## Dev Agent Record

### Agent Model Used

(To be filled by Dev Agent)

### Debug Log References

(To be filled by Dev Agent)

### Completion Notes List

(To be filled by Dev Agent)

### File List

(To be filled by Dev Agent)

---

## QA Results

(To be filled by QA Agent after story completion)
